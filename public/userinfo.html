<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>AI Agent - by DHS</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Ubuntu:wght@500;700&display=swap"
        rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
    <!-- Spinner Start -->
    <div id="spinner"
        class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-grow text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Spinner End -->


    <!-- Navbar Start -->
    <div class="container-fluid sticky-top">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-dark p-0">
                <a href="index.html" class="navbar-brand">
                    <h1 class="text-white">DANGHS<span class="text-dark">.</span>ID<span class="text-dark">.</span>VN</h1>
                </a>
                <button type="button" class="navbar-toggler ms-auto me-0" data-bs-toggle="collapse"
                    data-bs-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <div class="navbar-nav ms-auto">
                        <a href="index.html" class="nav-item nav-link">Home</a>
                        <a href="about.html" class="nav-item nav-link">About</a>
                        <a href="service.html" class="nav-item nav-link">Services</a>
                        <a href="chatbot.html" class="nav-item nav-link">Projects</a>
                        <a id="login-logout" class="nav-item nav-link" onclick="loginout()">Login</a>
                        <a id="user-link" class="nav-item nav-link active" onclick="userinfo()" >User</a>
                    </div>
                    <butaton type="button" class="btn text-white p-0 d-none d-lg-block" data-bs-toggle="modal"
                        data-bs-target="#searchModal"><i class="fa fa-search"></i></butaton>
                </div>
            </nav>
        </div>
    </div>
    <!-- Navbar End -->

       <!-- Hero Start -->
    <div class="container-fluid pt-5 bg-primary hero-header mb-5">
        <div class="container pt-5">
            <div class="row g-5 pt-5">
                <div class="col-lg-6 align-self-center text-center text-lg-start mb-lg-5">
                    <div class="btn btn-sm border rounded-pill text-white px-3 mb-3 animated slideInRight">Hello</div>
                    <h1 id="usermail" class="display-4 text-white mb-4 animated slideInRight"></h1>
                    <p class="text-white mb-4 animated slideInRight">Your AI agent's personality:</p>
                    <p id="personality" class="text-white mb-4 animated slideInRight"></p>
                    <p class="text-white mb-4 animated slideInRight">Memory:</p>
                    <p id="memory" class="text-white mb-4 animated slideInRight"></p>
                    <a href="chatbot.html" class="btn btn-outline-light py-sm-3 px-sm-5 rounded-pill animated slideInRight">Use</a>
                    <a href="train1.html" class="btn btn-outline-light py-sm-3 px-sm-5 rounded-pill animated slideInRight">Train Memory</a>
                    <a href="train2.html" class="btn btn-outline-light py-sm-3 px-sm-5 rounded-pill animated slideInRight">Train Personality</a>
                </div>
                <div class="col-lg-6 align-self-end text-center text-lg-end">
                    <img class="img-fluid" src="img/hero-img.png" alt="">
                </div>
            </div>
        </div>
    </div>
    <!-- Hero End -->

<!-- Footer Start -->
<div class="container-fluid bg-dark text-white-50 footer pt-5">
    <div class="container py-1">
        <div class="row g-5">
            <div class="col-md-6 col-lg-6 wow fadeIn" data-wow-delay="0.1s">
                <a href="index.html" class="d-inline-block mb-3">
                    <h1 class="text-white">DANGHS<span class="text-primary">.</span>ID<span class="text-primary">.</span>VN</h1>
                </a>
                <p class="mb-0">
                    The AI Agent is developed by Dang Ha Sang – a student at Ho Chi Minh City University of Technology.  
                    Your friendly and intelligent personal assistant, always ready to support you 24/7.
                </p>
            </div>
            <div class="col-md-6 col-lg-6 wow fadeIn" data-wow-delay="0.3s">
                <h5 class="text-white mb-4">Get In Touch</h5>
                <p><i class="fa fa-map-marker-alt me-3"></i>District 10, Ho Chi Minh City</p>
                <p><i class="fa fa-phone-alt me-3"></i>+84 899993702</p>
                <p><i class="fa fa-envelope me-3"></i>sang.danghs0812@hcmut.edu.vn</p>
                <div class="d-flex pt-2">
                    <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-twitter"></i></a>
                    <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-facebook-f"></i></a>
                    <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-youtube"></i></a>
                    <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-instagram"></i></a>
                    <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
        </div>
    </div>
    <div class="container wow fadeIn" data-wow-delay="0.1s">
        <div class="copyright">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    &copy; <a class="border-bottom" href="#">danghs.id.vn</a>, All Rights Reserved.
                    Designed by <a class="border-bottom" href="#">Dang Ha Sang</a>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Footer End -->



    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top pt-2"><i class="bi bi-arrow-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
   <script>
  document.addEventListener('DOMContentLoaded', async () => {
    const userLink = document.getElementById('user-link');
    const login = document.getElementById('login-logout');
    const token = localStorage.getItem('token');

    if (!token) {
      login.textContent = 'Login';
      userLink.href = 'auth.html';
      return;
    }
    else {
        login.textContent = 'Logout';
    }

    try {
      const response = await fetch('/user/getUserEmail', {
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        }
      });

      if (response.ok) {
        const data = await response.json();
        const username = data || 'User';
        userLink.textContent = username;
        userLink.href = '#'; // hoặc trang profile nếu có
      } else {
        // Token hết hạn hoặc không hợp lệ
        userLink.textContent = 'Login';
        userLink.href = 'auth.html';
        localStorage.removeItem('token');
      }
    } catch (error) {
      console.error('Lỗi khi lấy thông tin người dùng:', error);
      userLink.textContent = 'Login';
      userLink.href = 'auth.html';
    }
    const usermail = document.getElementById('usermail');
    try {
        const response = await fetch('/user/getUserInfo', {
        headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
        }
    })
    
    if (response.ok) {
        const data = await response.json();
        usermail.textContent = data.email;
    }}
    catch(error) {
        console.log(error);
    }
    const personality = document.getElementById('personality');
    const memory = document.getElementById('memory');
    try {
        const response = await fetch('/agent/getAgentInfo', {
        headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
        }
    })
    
    if (response.ok) {
        const data = await response.json();
        console.log(data);
        personality.textContent = data.personality_prompt;
        memory.innerHTML = `
            <ul>
                ${data.memory_json.memory.map(fact => `<li>${fact}</li>`).join("")}
            </ul>
            `;
    }}
    catch(error) {
        console.log(error);
    }
  });
    function loginout() {
        const login = document.getElementById('login-logout');
        console.log(login.textContent);
        if (login.textContent == 'Logout') {
            localStorage.removeItem('token');
            window.location.href = '/index.html';
            }
        else {window.location.href = '/auth.html'}
        }

    function userinfo() {
        const info = document.getElementById('user-link');
        console.log(info.textContent);
        if (info.textContent == 'User') window.location.href = '/auth.html';
        else window.location.href = '/userinfo.html';
    }
</script>

</body>

</html>